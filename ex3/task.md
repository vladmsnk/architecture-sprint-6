## Переход на Event-Driven архитектуру

1) Перевод сервиса ins-product-aggregator на использование kafka для публикации событий по страховым продуктам
- Реализуем асинхронный пулл воркеров. 
Воркеры будет синхронно обращаться в сторонние сервисы для получения информации по страховым продуктам.
На каждый сервис будет создаваться отдельный воркер. Управление воркерами будет осуществляться в помощью worker-pool.
- Воркер будет обращаться к сервису страховой компании по соответсвующему протоколу и проверять было ли изменение списка продуктов
- При изменении списка продуктов, создается запись в таблицу product_events с соответсвующим изменением
- Реализуется асинхронный процесс чтения списка новых событий и последующая отправка в топик Kafka. При
отправке события в топик, проставляется значение в колонке sent в таблице product_events.
- Настраиваем частоту обращения воркеров к сторонним сервисам в зависимости от бизнес требований
- Добавляем метрики для отслеживания response time при обращении к сторонним сервисам
- При возникновении ошибки при обращении логируем ошибку.

2) ins-comp-settlement (используется паттерн Event-Streaming)
- перестает синхронно обращаться в сервис ins-product-aggregator и подписывается на топик событий по страховым продуктам и тарифам
Сохраняет нужную информацию по страховым продуктам (например, для каждого продукта сохраняет его стоимость).
- перестает синхронно обращаться в сервис core-app. Вместо этого подписывается на топик событий по оформленным страховкам.
- Сохраняет их в соответсвующую локальную таблицу
- Во время запуска процесса сверки, данные по оформленным страховкам и их тарифам извлекаются из локальной СУБД.
- обеспечиваем механизмы повторной обработки событий в случаях ошибок, а также добавляем механизм дедуплекации
- Добавляем мониторинг на отслеживания кол-ва ошибок при обработке событий, а также на кол-во обрабатываемых сообщений

3) core-app
- перестает синхронно обращаться в сервис ins-product-aggregator и подписывается на топик событий по страховым продуктам и тарифам
- при получении списка доступных продуктов, данные извлекаются из локального хранилища
- если будет хватать ресурсов, используем паттерн Server Send Events для обновления доступных продуктов на стороне FE
- при оформлении страховки пишем соответствующее событие в таблицу, в дальнейшем асинхронный процесс будет отправлять эти 
события в топик Kafka. Используем Паттерн Transactional Outbox
- Добавляем аллерты на ошибки во время отправки событий 
- добиваемся того, что страховка оформляется транзакционно. Все события, которые необходимо отправить сначала пишутся в таблицу,
затем считываются оттуда и отправляются в Kafka
Дополнительно:
- асинхронный процесс оплаты страховки с помощью паттерна Transactional Outbox. То есть, при оформлении страховки, сначал заявка переходит
в статус reserved, а далее в статус confirmed после успешной оплаты.
- используем паттерн Event Sourcing для аудита заявок по оформлению страховок 
